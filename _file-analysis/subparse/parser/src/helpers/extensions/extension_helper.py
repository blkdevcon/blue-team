from src.helpers.singleton import MetaClassSingleton

class ExtensionHelper(metaclass=MetaClassSingleton):
    """
    Extension Helper, this object helps to match file magic data with the derived extension in the instance 
        that the file content does not match the extension on the file

    Attributes
    ----------
        - _file_extension: dict
            Private attribute used for reference between the mime type and common file extension.

    Methods
    -------
        - get_extension_from_mime(mime: str): str
                Gets the matched extension from the mime type passed in the parameter
    """
    def __init__(self) -> None:
        self._file_extension = {
            "application/pdf" : ".pdf",
            "application/java-archive" : ".jar",
            "application/x-stuffit" : ".zip",
            "application/gzip" : ".tar.gz",
            "application/vnd.airzip.filesecure.azf" : ".azf",
            "application/vnd.airzip.filesecure.azs" : ".azs",
            "application/vnd.android.package-archive" : ".apk",
            "application/vnd.joost.joda-archive" : ".joda",
            "application/vnd.ms-cab-compressed" : ".cab",
            "application/x-7z-compressed" : ".7z",
            "application/x-stuffitx" : ".sit",
            "application/zip" : ".zip",
            "application/x-ace-compressed" : ".ace",
            "application/x-apple-diskimage" : ".dmg",
            "application/x-bcpio" : ".bcpio",
            "application/x-bzip" : ".bz",
            "application/x-bzip2" : ".bz2",
            "application/x-debian-package" : ".deb",
            "application/x-gtar" : ".gtar",
            "application/x-rar" : ".rar",
            "application/x-rar-compressed" : ".rar",
            "application/x-shar" : ".shar",
            "application/x-ustar" : ".tar",
            "application/x-gzip" : ".tar",
            "application/x-tar" : ".ustar",
            "audio/vnd.dts.hd" : ".dtshd",
            "audio/x-ms-wma" : ".wma",
            "audio/x-ms-wax" : ".wax",
            "audio/x-mpegurl" : ".m3u",
            "audio/x-aiff" : ".aif",
            "audio/x-aac" : ".aac",
            "audio/webm" : ".weba",
            "audio/vnd.rip" : ".rip",
            "audio/vnd.nuera.ecelp9600" : ".ecelp9600",
            "audio/vnd.nuera.ecelp7470" : ".ecelp7470",
            "audio/vnd.nuera.ecelp4800" : ".ecelp4800",
            "audio/vnd.ms-playready.media.pya" : ".pya",
            "audio/vnd.lucent.voice" : ".lvp",
            "audio/vnd.dts" : ".dts",
            "audio/vnd.dra" : ".dra",
            "audio/vnd.digital-winds" : ".eol",
            "audio/vnd.dece.audio" : ".uva",
            "audio/ogg" : ".oga",
            "audio/mpeg" : ".mpga",
            "audio/mp4" : ".mp4a",
            "audio/midi" : ".mid",
            "audio/basic" : ".au",
            "audio/adpcm" : ".adp",
            "application/vnd.apple.mpegurl" : ".m3u8",
            "application/vnd.epson.msf" : ".msf",
            "application/vnd.yamaha.smaf-phrase" : ".spf",
            "application/xspf+xml" : ".xspf",
            "application/vnd.yamaha.smaf-audio" : ".saf",
            "application/vnd.yamaha.openscoreformat.osfpvg+xml" : ".osfpvg",
            "application/vnd.yamaha.openscoreformat" : ".osf",
            "application/vnd.yamaha.hv-voice" : ".hvp",
            "application/vnd.yamaha.hv-script" : ".hvs",
            "application/vnd.yamaha.hv-dic" : ".hvd",
            "application/vnd.epson.esf" : ".esf",
            "application/vnd.epson.ssf" : ".ssf",
            "audio/x-wav" : ".wav",
            "audio/x-pn-realaudio-plugin" : ".rmp",
            "audio/x-pn-realaudio" : ".ram",
            "chemical/x-xyz" : ".xyz",
            "chemical/x-csml" : ".csml",
            "chemical/x-cml" : ".cml",
            "chemical/x-cmdf" : ".cmdf",
            "chemical/x-cif" : ".cif",
            "chemical/x-cdx" : ".cdx",
            "application/cdmi-queue" : ".cdmiq",
            "application/cdmi-object" : ".cdmio",
            "application/cdmi-domain" : ".cdmid",
            "application/cdmi-container" : ".cdmic",
            "application/cdmi-capability" : ".cmdia",
            "text/yaml" : ".yaml",
            "application/xml-dtd" : ".xslt",
            "application/xslt+xml" : ".dtd",
            "application/xml" : ".xml",
            "application/xhtml+xml" : ".xhtml",
            "application/voicexml+xml" : ".vxml",
            "application/vnd.syncml+xml" : ".xsm",
            "application/vnd.syncml.dm+xml" : ".xdm",
            "text/sgml" : ".sgml",
            "text/vnd.wap.wml" : ".wml",
            "application/vnd.syncml.dm+wbxml" : ".bdm",
            "application/postscript" : ".ai",
            "application/pkcs7-mime" : ".p7m",
            "application/pics-rules" : ".prf",
            "application/pgp-signature" : ".pgp",
            "application/pgp-encrypted" : ".pgp",
            "application/x-x509-ca-cert" : ".der",
            "application/x-pkcs7-certreqresp" : ".p7r",
            "application/x-pkcs7-certificates" : ".p7b",
            "application/x-pkcs12" : ".p12",
            "application/scvp-vp-response" : ".spp",
            "application/scvp-vp-request" : ".spq",
            "application/scvp-cv-response" : ".scs",
            "application/scvp-cv-request" : ".scq",
            "application/pkix-pkipath" : ".pkipath",
            "application/pkix-crl" : ".crl",
            "application/pkixcmp" : ".pki",
            "application/pkix-cert" : ".cer",
            "application/pkix-attr-cert" : ".ac",
            "application/pkcs8" : ".p8",
            "application/pkcs7-signature" : ",p7s",
            "application/pkcs10" : ".p10",
            "application/vnd.microsoft.portable-executable" : ".exe",
            "application/x-dosexec" : ".exe",
            "application/x-msdownload" : ".exe",
            "application/x-msi" : ".msi",
            "application/x-sh" : ".sh",
            "application/x-msdos-program" : ".bat",
            "application/bat" : ".bat",
            "application/x-bat" : ".bat",
            "application/bat" : ".bat",
            "application/octet-stream*" : ".bin",
            "text/x-python" : ".py",
            "application/x-ms-application" : ".application",
            "application/mediaservercontrol+xml" : ".mscml",
            "application/wsdl+xml" : ".wsdl",
            "application/wspolicy+xml" : ".wspolicy",
            "model/mesh" : ".mesh",
            "application/vnd.amazon.ebook" : ".azw",
            "application/epub+zip" : ".epub",
            "application/vnd.crick.clicker.keyboard" : ".clkk",
            "application/vnd.crick.clicker" : ".clkx",
            "application/vnd.crick.clicker.palette" : ".clkp",
            "application/vnd.crick.clicker.wordbank" : ".clkw",
            "application/vnd.crick.clicker.template" : ".clkt",
            "message/rfc822" : ".eml",
            "text/javascript" : ".js",
            "application/sparql-query" : ".rq",
            "application/ecmascript" : ".es",
            "application/javascript" : ".js",
            "text/vnd.wap.wmlscript" : ".wmls",
            "application/x-csh" : ".csh",
            "application/x-tcl" : ".tcl",
            "application/vnd.intu.qbo" : ".qbo",
            "application/vnd.intu.qfx" : ".qfx",
            "application/vnd.accpac.simply.imp" : ".imp",
            "application/vnd.accpac.simply.aso" : ".aso",
            "application/octet-stream" : ".bin",
            "application/base64" : ".mm",
            "text/x-uuencode" : ".uu",
            "application/vnd.google-earth.kml+xml" : ".kml",
            "application/vnd.google-earth.kmz" : ".kmz",
            "application/vnd.lotus-notes" : ".nsf",
            "application/vnd.lotus-freelance" : ".pre",
            "application/vnd.lotus-approach" : ".apr",
            "application/vnd.lotus-wordpro" : ".lwp",
            "application/vnd.lotus-screencam" : ".scm",
            "application/vnd.lotus-1-2-3" : ".123",
            "application/vnd.lotus-organizer" : ".org",
            "image/cgm" : ".cgm",
            "image/vnd.adobe.photoshop" : ".psd",
            "image/bmp" : ".bmp",
            "image/x-xwindowdump" : ".xwd",
            "image/x-xpixmap" : ".xpm",
            "image/x-xbitmap" : ".xbm",
            "image/x-rgb" : ".rgb",
            "image/x-portable-pixmap" : ".ppm",
            "image/x-portable-graymap" : ".pgm",
            "image/x-portable-bitmap" : ".pbm",
            "image/x-portable-anymap" : ".pnm",
            "image/x-png" : ".png",
            "image/x-pict" : ".pic",
            "image/x-pcx" : ".pcx",
            "image/x-icon" : ".ico",
            "image/x-freehand" : ".fh",
            "image/x-cmx" : ".cmx",
            "image/x-cmu-raster" : ".ras",
            "image/x-citrix-png" : ".png",
            "image/x-citrix-jpeg" : ".jpeg",
            "image/webp" : ".webp",
            "image/vnd.xiff" : ".xif",
            "image/vnd.wap.wbmp" : ".wbmp",
            "image/vnd.net-fpx" : ".npx",
            "image/vnd.ms-modi" : ".mdi",
            "image/vnd.fujixerox.edmics-rlc" : ".rlc",
            "image/vnd.fujixerox.edmics-mmr" : ".mmr",
            "image/vnd.fst" : ".fst",
            "image/vnd.fpx" : ".fpx",
            "image/vnd.fastbidsheet" : ".fbs",
            "image/vnd.dxf" : ".dxf",
            "image/vnd.dece.graphic" : ".uvi",
            "image/vnd.dwg" : ".dwg",
            "image/vnd.dvb.subtitle" : ".sub",
            "image/vnd.djvu" : ".djvu",
            "image/g3fax" : ".g3",
            "image/gif" : ".gif",
            "image/ief" : ".ief",
            "image/jpeg" : ".jpeg",
            "image/ktx" : ".ktx",
            "image/pjpeg" : ".pjpeg",
            "image/png" : ".png",
            "image/prs.btif" : ".btif",
            "image/svg+xml" : ".svg",
            "image/tiff" : ".tiff",
            "application/vnd.apple.installer+xml" : ".mpkg",
            "application/x-xpinstall" : ".xpi",
            "application/vnd.adobe.air-application-installer-package+zip" : ".air",
            "application/vnd.kde.karbon" : ".karbon",
            "application/vnd.kde.kchart" : ".chrt",
            "application/vnd.kde.kformula" : ".kfo",
            "application/vnd.kde.kivio" : ".flw",
            "application/vnd.kde.kontour" : ".kon",
            "application/vnd.kde.kpresenter" : ".kpr",
            "application/vnd.kde.kspread" : ".ksp",
            "application/vnd.kde.kword" : ".kwd",
            "application/x-msbinder" : ".obd",
            "application/vnd.openxmlformats-officedocument.presentationml.slide" : ".sldx",
            "application/x-mscardfile" : ".crd",
            "application/vnd.visio" : ".vsd",
            "application/x-msclip" : ".clp",
            "application/x-msmediaview" : ".mvb",
            "application/x-msmetafile" : ".wmf",
            "application/x-msmoney" : ".mny",
            "application/x-mspublisher" : ".pub",
            "application/x-msschedule" : ".scd",
            "application/vnd.ms-htmlhelp" : ".chm",
            "application/vnd.ms-powerpoint" : ".ppt",
            "application/vnd.ms-powerpoint.addin.macroenabled.12" : ".ppam",
            "application/vnd.ms-powerpoint.presentation.macroenabled.12" : ".pptm",
            "application/vnd.ms-powerpoint.slide.macroenabled.12" : ".sldm",
            "application/vnd.ms-powerpoint.slideshow.macroenabled.12" : ".ppsm",
            "application/vnd.openxmlformats-officedocument.wordprocessingml.template" : ".dotx",
            "application/x-mswrite" : ".wri",
            "application/vnd.ms-works" : ".wps",
            "application/vnd.ms-powerpoint.template.macroenabled.12" : ".potm",
            "application/vnd.ms-project" : ".mpp",
            "application/vnd.ms-word.document.macroenabled.12" : ".docm",
            "application/vnd.ms-word.template.macroenabled.12" : ".dotm",
            "application/vnd.openxmlformats-officedocument.presentationml.presentation" : ".pptx",
            "application/vnd.openxmlformats-officedocument.wordprocessingml.document" : ".docx",
            "application/vnd.openxmlformats-officedocument.spreadsheetml.template" : ".xltx",
            "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" : ".xlsx",
            "application/vnd.openxmlformats-officedocument.presentationml.template" : ".potx",
            "application/vnd.openxmlformats-officedocument.presentationml.slideshow" : ".ppsx",
            "application/msword" : ".doc",
            "application/onenote" : ".onetoc",
            "application/vnd.ms-excel" : ".xls",
            "application/vnd.ms-artgalry" : ".cil",
            "application/vnd.ms-excel.addin.macroenabled.12" : ".xlam",
            "application/vnd.ms-excel.sheet.binary.macroenabled.12" : ".xlsb",
            "application/vnd.ms-excel.sheet.macroenabled.12" : ".xlsm",
            "application/vnd.ms-excel.template.macroenabled.12" : ".xltm",
            "application/vnd.visio2013" : ".vsdx",
            "application/x-msaccess" : ".mdb",
            "model/iges" : ".igs",
            "text/vnd.fmi.flexstor" : ".flx",
            "model/vnd.collada+xml" : ".dae",
            "model/vnd.dwf" : ".dwf",
            "model/vnd.gdl" : ".gdl",
            "model/vnd.gtw" : ".gtw",
            "model/vnd.mts" : ".mts",
            "model/vnd.vtu" : ".vtu",
            "model/vrml" : ".wrl",
            "application/vnd.oasis.opendocument.chart-template" : ".otc",
            "application/vnd.oasis.opendocument.spreadsheet-template" : ".ots",
            "application/vnd.oasis.opendocument.text" : ".odt",
            "application/vnd.oasis.opendocument.text-master" : ".odm",
            "application/vnd.oasis.opendocument.text-template" : ".ott",
            "application/vnd.oasis.opendocument.text-web" : ".oth",
            "application/vnd.openofficeorg.extension" : ".oxt",
            "application/vnd.sun.xml.math" : ".sxm",
            "application/vnd.stardivision.impress" : ".sdd",
            "application/vnd.stardivision.draw" : ".sda",
            "application/vnd.stardivision.calc" : ".sdc",
            "application/vnd.oasis.opendocument.database" : ".odb",
            "application/vnd.oasis.opendocument.formula" : ".odf",
            "application/vnd.oasis.opendocument.formula-template" : ".odft",
            "application/vnd.oasis.opendocument.graphics" : ".odg",
            "application/vnd.sun.xml.writer.template" : ".stw",
            "application/vnd.sun.xml.writer.global" : ".sxg",
            "application/vnd.sun.xml.writer" : ".sxw",
            "application/vnd.oasis.opendocument.graphics-template" : ".otg",
            "application/vnd.oasis.opendocument.image" : ".odi",
            "application/vnd.oasis.opendocument.image-template" : ".oti",
            "application/vnd.oasis.opendocument.presentation" : ".odp",
            "application/vnd.oasis.opendocument.presentation-template" : ".otp",
            "application/vnd.oasis.opendocument.spreadsheet" : ".ods",
            "application/vnd.sun.xml.impress.template" : ".sti",
            "application/vnd.sun.xml.impress" : ".sxi",
            "application/vnd.sun.xml.draw.template" : ".std",
            "application/vnd.sun.xml.draw" : ".sxd",
            "application/vnd.sun.xml.calc.template" : ".stc",
            "application/vnd.sun.xml.calc" : ".sxc",
            "application/vnd.stardivision.writer-global" : ".sgl",
            "application/vnd.stardivision.writer" : ".sdw",
            "application/vnd.stardivision.math" : ".smf",
            "application/vnd.oasis.opendocument.chart" : ".odc",
            "application/x-authorware-seg" : ".aas",
            "application/x-authorware-map" : ".aam",
            "application/x-authorware-bin" : ".aab",
            "application/vnd.adobe.xfdf" : ".xfdf",
            "application/vnd.adobe.xdp+xml" : ".xdp",
            "application/vnd.adobe.fxp" : ".fxp",
            "application/vnd.ahead.space" : ".ahead",
            "application/vnd.ms-xpsdocument" : ".xps",
            "application/winhlp" : ".hlp",
            "application/vnd.uoml+xml" : ".uoml",
            "application/x-tex" : ".tex",
            "text/n3" : ".n3",
            "text/troff" : ".t",
            "text/turtle" : ".ttl",
            "text/vnd.in3d.3dml" : ".3dml",
            "text/vnd.in3d.spot" : ".spot",
            "application/resource-lists+xml" : ".rl",
            "application/resource-lists-diff+xml" : ".rld",
            "application/rls-services+xml" : ".rs",
            "application/rsd+xml" : ".rs",
            "application/rss+xml" : ".rss",
            "application/sbml+xml" : ".sbml",
            "application/shf+xml" : ".shf",
            "application/smil+xml" : ".smi",
            "application/sparql-results+xml" : ".srx",
            "application/srgs+xml" : ".grxml",
            "application/sru+xml" : ".sru",
            "application/ssml+xml" : ".ssml",
            "application/tei+xml" : ".tei",
            "application/thraud+xml" : ".tfi",
            "application/vnd.chemdraw+xml" : ".cdxml",
            "application/wsdl+xml" : ".wsdl",
            "application/x-latex" : ".latex",
            "application/xv+xml" : ".mxml",
            "application/x-texinfo" : ".texinfo",
            "application/atom+xml" : ".atom",
            "application/atomcat+xml" : ".atomcat",
            "application/atomsvc+xml" : ".atomsvc",
            "application/ccxml+xml" : ".ccxml",
            "application/davmount+xml" : ".davmount",
            "application/dssc+xml" : ".xdssc",
            "application/emma+xml" : ".emma",
            "application/mads+xml" : ".mads",
            "application/marcxml+xml" : ".mrcx",
            "application/mathml+xml" : ".mathml",
            "application/mediaservercontrol+xml" : ".mscml",
            "application/metalink4+xml" : ".meta4",
            "application/mets+xml" : ".mets",
            "application/mods+xml" : ".mods",
            "application/oebps-package+xml" : ".opf",
            "application/pls+xml" : ".pls",
            "application/vnd.ms-officetheme" : ".thmx",
            "application/vnd.ms-pki.stl" : ".stl",
            "application/x-msterminal" : ".trm",
            "application/vnd.ms-pki.seccat" : ".cat",
            "application/vnd.ms-ims" : ".ims",
            "application/vnd.ms-lrm" : ".lrm",
            "application/vnd.wordperfect" : ".wpd",
            "application/oda" : ".oda",
            "text/x-vcard" : ".vcf",
            "application/rtf" : ".rtf",
            "text/x-vcalendar" : ".vcs",
            "text/vnd.graphviz" : ".gv",
            "text/tab-separated-values" : ".tsv",
            "text/csv" : ".csv",
            "text/calendar" : ".ics",
            "application/vnd.quark.quarkxpress" : ".qxd",
            "text/x-pascal" : ".p",
            "text/x-java-source,java" : ".java",
            "text/x-fortran" : ".f",
            "text/x-c" : ".c",
            "text/x-asm" : ".s",
            "text/x-java-source" : ".java",
            "application/java-vm" : ".class",
            "application/vnd.acucorp" : ".atc",
            "application/vnd.acucobol" : ".acu",
            "application/json" : ".json",
            "text/vnd.curl" : ".curl",
            "text/vnd.curl.dcurl" : ".dcurl",
            "text/vnd.curl.mcurl" : ".mcurl",
            "text/vnd.curl.scurl" : ".scurl",
            "text/x-setext" : ".etx",
            "text/plain" : ".txt",
            "text/vnd.sun.j2me.app-descriptor" : ".jad",
            "text/vnd.fly" : ".fly",
            "text/plain-bas" : ".par",
            "text/prs.lines.tag" : ".dsc",
            "text/richtext" : ".rtx",
            "text/uri-list" : ".uri",
            "application/x-bittorrent" : ".torrent",
            "video/x-msvideo" : ".avi",
            "video/mp4" : ".mp4",
            "video/mj2" : ".mj2",
            "video/jpm" : ".jpm",
            "video/jpeg" : ".jpgv",
            "video/3gpp2" : ".3g2",
            "video/3gpp" : ".3gp",
            "application/x-silverlight-app" : ".xap",
            "video/x-ms-wm" : ".wm",
            "video/x-ms-wmv" : ".wmv",
            "video/x-ms-wmx" : ".wmx",
            "video/h264" : ".h264",
            "video/x-ms-wvx" : ".wvx",
            "video/x-sgi-movie" : ".movie",
            "application/vnd.mseq" : ".mseq",
            "application/vnd.epson.quickanime" : ".qam",
            "application/x-shockwave-flash" : ".swf",
            "application/x-ms-wmz" : ".wmz",
            "application/x-ms-wmd" : ".wmd",
            "application/vnd.rn-realmedia" : ".rm",
            "application/mp4" : ".mp4",
            "application/mp21" : ".m21",
            "video/h261" : ".h261",
            "video/h263" : ".h263",
            "application/vnd.epson.salt" : ".slt",
            "application/vnd.google-apps.video" : ".ogx",
            "application/vnd.ms-wpl" : ".wpl",
            "application/x-director" : ".dir",
            "video/x-f4v" : ".f4v",
            "video/vnd.dece.video" : ".uvv",
            "video/vnd.dece.sd" : ".uvs",
            "video/vnd.dece.pd" : ".uvp",
            "video/vnd.dece.mobile" : ".uvm",
            "video/vnd.dece.hd" : ".uvh",
            "video/quicktime" : ".qt",
            "video/ogg" : ".ogv",
            "video/mpeg" : ".mpeg",
            "video/x-fli" : ".fli",
            "video/x-flv" : ".flv",
            "video/x-m4v" : ".m4v",
            "video/x-ms-asf" : ".asf",
            "video/webm" : ".webm",
            "video/vnd.fvt" : ".fvt",
            "application/x-cdlink" : ".vcd",
            "application/x-dvi" : ".dvi",
            "application/ogg" : ".ogx",
            "video/vnd.mpegurl" : ".mxu",
            "video/vnd.ms-playready.media.pyv" : ".pyv",
            "video/vnd.uvvu.mp4" : ".uvu",
            "video/vnd.vivo" : ".viv",
            "text/html" : ".html",
            "text/css" : ".css",
            "application/x-elf" : ".elf",
            "application/x-executable" : ".elf",
            "application/x-coredump" : ".elf",
            "application/x-object" : ".elf",
            "application/x-sharedlib" : ".elf",
            "text/rtf" : ".rtf",
            "text/x-script.python" : ".py",
            "application/x-sylk" : ".slk",
            "text/x-php" : ".php",
            "text/x-perl" : ".pl",
            "text/x-shellscript" : ".sh",
            "application/x-mach-binary" : "bundle",
            "application/x-compress" : ".zip",
            "application/x-rpm" : ".rpm"
        }


    def get_extension_from_mime(self, mime: str):
        """
        Given a mime type this function will return the derived common extension for that type.

        Parameters
        ----------
            - mime: str, required
                Mime type to find        

        Returns
        -------
        String
        """
        if mime in self._file_extension:
            return self._file_extension[mime]
        else:
            return None